import type { OnChanges } from '@angular/core';
import { Component, Injectable, Input } from '@angular/core';
import type { DomSanitizer, SafeResourceUrl } from '@angular/platform-browser';

@Injectable()
export class ApiService {
  data: string = 'original Api Service';
}

@Component({
  standalone: true,
  // Needs to be a different name to the CLI template button
  template: `@if (src) {
  <img [src]="src" title="test" />
  {{ caption }}
}`,
  selector: 'sanitizer-component',
})
export default class SanitizerTestComponent implements OnChanges {
  @Input() caption: string = '';
  src: SafeResourceUrl | null = null;
  svgAsBase64 =
    'data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz48IS0tIFVwbG9hZGVkIHRvOiBTVkcgUmVwbywgd3d3LnN2Z3JlcG8uY29tLCBHZW5lcmF0b3I6IFNWRyBSZXBvIE1peGVyIFRvb2xzIC0tPgo8c3ZnIHdpZHRoPSI4MDBweCIgaGVpZ2h0PSI4MDBweCIgdmlld0JveD0iMCAwIDQwMCA0MDAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+DQo8cGF0aCBkPSJNMTg2LjYxNCA3Mi40NzMxQzIyNC4zNzkgNDguNzQ3OSAyNDkuMTI1IDk1Ljg4NzcgMjE3LjU3MyAxMjIuODcyQzIxMS4yMTYgMTI4LjMwNyAyMDMuOTUgMTMxIDE5NS41NzUgMTMxQzE2Ni42NjMgMTMxIDE3NC44MjIgOTguMDE4MSAxODAuOTExIDc5Ljc4ODYiIHN0cm9rZT0iIzAwMDAwMCIgc3Ryb2tlLW9wYWNpdHk9IjAuOSIgc3Ryb2tlLXdpZHRoPSIxNiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIi8+DQo8cGF0aCBkPSJNMTU5LjU5OSAxMzUuMzA2QzE1OS41OTkgMTY1LjgxNCAxNjYuMTYxIDE5Mi42NzYgMTY3LjI0NSAyMjAuMTk3QzE2OC41OTQgMjU0LjQzOSAxNjYuOTQ4IDI5NC42MjYgMTU5LjU5NCAzNjcuNDI5IiBzdHJva2U9IiMwMDAwMDAiIHN0cm9rZS1vcGFjaXR5PSIwLjkiIHN0cm9rZS13aWR0aD0iMTYiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIvPg0KPHBhdGggZD0iTTIzMy44MTcgMTQwLjk0OEMyMzYuNTI2IDE2Ny4xNDEgMjI5Ljg5NCAxODQuMzg0IDIyOC40ODUgMTk2LjA1QzIzMi4yOTQgMzMyLjc5OCAyMzcuMzcyIDM1MS43MjkgMjM3LjM3MiAzNzEuMTM0IiBzdHJva2U9IiMwMDAwMDAiIHN0cm9rZS1vcGFjaXR5PSIwLjkiIHN0cm9rZS13aWR0aD0iMTYiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIvPg0KPHBhdGggZD0iTTIzMy44MzMgMTQwLjk0NkMyNTQuMTggMTI5Ljg2MyAyODcuODY2IDEyMC4xMTYgMjgzLjYwMyA5MC4yODc4QzI4My4wOTMgODYuNzE5OCAyODQuNDY1IDg0Ljk1NTcgMjgwLjA0OCA4NC45NTU3IiBzdHJva2U9IiMwMDAwMDAiIHN0cm9rZS1vcGFjaXR5PSIwLjkiIHN0cm9rZS13aWR0aD0iMTYiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIvPg0KPHBhdGggZD0iTTE1Ny4yNTIgMTM2LjU3OEMxMjYuMDIzIDEzOS41MjMgMTA3LjQ4OCAxMDEuNDc5IDExNi45OTMgNzIuOTYzNSIgc3Ryb2tlPSIjMDAwMDAwIiBzdHJva2Utb3BhY2l0eT0iMC45IiBzdHJva2Utd2lkdGg9IjE2IiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiLz4NCjxwYXRoIGQ9Ik0xMTkuODMgNjEuMzkyOUMxMDcuNDcxIDQzLjQ5OTUgMTQxLjE0NiAxNC42MzkzIDE1My42NjIgMzQuNjYyOUMxNTkuMTk2IDQzLjUxNTQgMTQ1LjUzNiA2OS43OTk3IDEzNS43MDIgNjMuODk5OCIgc3Ryb2tlPSIjMDAwMDAwIiBzdHJva2Utb3BhY2l0eT0iMC45IiBzdHJva2Utd2lkdGg9IjE2IiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiLz4NCjxwYXRoIGQ9Ik0yODQuMTY1IDcyLjQ5OUMyODQuOTkgNjcuODg4NCAyODUgNjMuMDMzNyAyODUgNTguMjk4NEMyODUgMTMuNDY1NCAyMjYuMTYgNDUuNzMxOSAyNTEuNTg1IDU2LjYyOThDMjU2LjY2IDU4LjgwMjQgMjU4LjE1MSA2Mi4yMTY2IDI2NC4xMTcgNjEuMjI0NSIgc3Ryb2tlPSIjMDAwMDAwIiBzdHJva2Utb3BhY2l0eT0iMC45IiBzdHJva2Utd2lkdGg9IjE2IiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiLz4NCjxwYXRoIGQ9Ik0xNzUuMTM3IDIyMy44NjZDMTkyLjMwOSAyMjMuNjQzIDIxMC4xMzYgMjE5LjYyNyAyMjcuMzQ4IDIyMS43NzUiIHN0cm9rZT0iIzAwMDAwMCIgc3Ryb2tlLW9wYWNpdHk9IjAuOSIgc3Ryb2tlLXdpZHRoPSIxNiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIi8+DQo8cGF0aCBkPSJNMTcwLjIwNyAyNjcuODMyQzE4OS4zODkgMjY4LjkzMyAyMTEuMjU3IDI2My45OTkgMjI5LjkzMyAyNjguNjY4IiBzdHJva2U9IiMwMDAwMDAiIHN0cm9rZS1vcGFjaXR5PSIwLjkiIHN0cm9rZS13aWR0aD0iMTYiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIvPg0KPHBhdGggZD0iTTE5OS4zODcgMjM0Ljc4N0MxOTkuMzg3IDIzMS4yMjYgMTk5LjM4NyAyMzAuMzcxIDE5OS4zODcgMjI2LjgyOCIgc3Ryb2tlPSIjMDAwMDAwIiBzdHJva2Utb3BhY2l0eT0iMC45IiBzdHJva2Utd2lkdGg9IjE2IiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiLz4NCjxwYXRoIGQ9Ik0xNDguOTgzIDM3MC4wODFDMTUxLjQxMyAzNjguOTAyIDE1NC4xNTggMzY4LjUwMSAxNTYuOTQyIDM2Ny40MjgiIHN0cm9rZT0iIzAwMDAwMCIgc3Ryb2tlLW9wYWNpdHk9IjAuOSIgc3Ryb2tlLXdpZHRoPSIxNiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIi8+DQo8cGF0aCBkPSJNMjM5LjE3OSAzNzEuMDQ3QzI0Mi45OTkgMzcwLjE3NyAyNDYuMzk3IDM3MS4xNzcgMjUwLjA1MyAzNzEuMTc3IiBzdHJva2U9IiMwMDAwMDAiIHN0cm9rZS1vcGFjaXR5PSIwLjkiIHN0cm9rZS13aWR0aD0iMTYiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIvPg0KPC9zdmc+';

  constructor(public sanitizer: DomSanitizer) {}

  ngOnChanges() {
    this.src = this.sanitizer.bypassSecurityTrustResourceUrl(this.svgAsBase64);
    console.log(this.src);
  }
}
